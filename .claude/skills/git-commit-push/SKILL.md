---
name: git-commit-push
description: Git 변경사항을 분석하여 요약 커밋 메시지를 작성하고 커밋/푸시/PR생성/머지를 수행합니다. 사용 시점: (1) "커밋해줘" (2) "푸시해줘" (3) "커밋 푸시해줘" (4) "백업해줘" (5) "변경사항 커밋하고 푸시" (6) "변경사항 저장해줘" (7) "PR 만들어줘" (8) "머지해줘" (9) 작업 완료 후 저장이 필요할 때. **중요: Git 커밋/푸시/PR/머지 요청 시 Bash 도구 대신 이 스킬을 우선 사용.**
---

# Git Commit, Push, PR & Merge

변경사항을 분석하여 의미있는 커밋 메시지를 작성하고, 커밋/푸시/PR생성/머지를 수행합니다.

## 워크플로우

### 1. 변경사항 확인

```bash
git status --short
```

변경사항이 없으면 "커밋할 변경사항이 없습니다"라고 알리고 종료.

### 2. 변경 내용 분석

```bash
# 수정된 파일 diff 확인
git diff --stat

# 상세 내용이 필요하면
git diff --name-status
```

### 3. 변경사항 분류

변경된 파일들을 다음 카테고리로 분류:
- **인물사전**: `04_Networking/00_인물사전/` 관련
- **프로젝트**: `00_A_Projects/` 관련
- **리소스**: `10_Resources/` 관련
- **스킬/에이전트**: `.claude/` 관련
- **기타**: 위에 해당하지 않는 것

### 4. 커밋 메시지 작성

형식:
```
[카테고리] 주요 변경 요약

- 세부 변경사항 1
- 세부 변경사항 2
```

예시:
```
[인물사전] 6명 인물 정보 업데이트

- 신규: 커밍쏜(ASC), 김병준(H인텔리전스)
- 업데이트: 박유빈, 박원녕, 최천우, 임해룡
```

### 5. 커밋 실행

```bash
git add .
git commit -m "커밋 메시지"
```

### 6. 푸시 실행

```bash
git push
```

푸시 실패 시 (upstream 미설정):
```bash
git push -u origin $(git branch --show-current)
```

### 7. 결과 보고

커밋 해시와 푸시 결과를 사용자에게 알림.

---

## PR 생성 및 머지 워크플로우

사용자가 "PR 만들어줘", "머지해줘" 등을 요청하거나 피처 브랜치에서 작업 완료 후 명시적으로 요청한 경우 실행.

### 8. 현재 브랜치 확인

```bash
git branch --show-current
```

main/master 브랜치인 경우:
- "현재 main 브랜치입니다. PR을 생성하려면 별도의 브랜치가 필요합니다"라고 안내
- 필요시 새 브랜치 생성 제안

### 9. PR 생성

```bash
# PR 제목과 본문 준비
# 커밋 메시지들을 분석하여 PR 요약 작성

gh pr create --title "[카테고리] PR 제목" --body "$(cat <<'EOF'
## Summary
- 주요 변경사항 1
- 주요 변경사항 2

## Changes
- 세부 변경 내역

🤖 Generated with Claude Code
EOF
)"
```

PR 생성 성공 시 PR URL을 사용자에게 표시.

### 10. PR 머지

```bash
# PR 상태 확인
gh pr status

# 머지 가능 여부 확인
gh pr checks

# 머지 실행 (squash merge 기본)
gh pr merge --squash --delete-branch
```

머지 옵션:
- `--squash`: 커밋을 하나로 합쳐서 머지 (기본값)
- `--merge`: 일반 머지 커밋 생성
- `--rebase`: 리베이스 후 머지
- `--delete-branch`: 머지 후 브랜치 삭제

### 11. 머지 후 정리

```bash
# main 브랜치로 이동
git checkout main

# 최신 상태로 업데이트
git pull origin main
```

---

## 전체 플로우 옵션

사용자 요청에 따라 다음 플로우 중 선택:

| 요청 | 실행 단계 |
|------|----------|
| "커밋해줘" | 1-5 |
| "푸시해줘" | 6 |
| "커밋 푸시해줘" | 1-7 |
| "PR 만들어줘" | 8-9 |
| "머지해줘" | 10-11 |
| "커밋하고 PR까지" | 1-9 |
| "전부 다 해줘" / "머지까지" | 1-11 |

## 주의사항

- `.obsidian/` 폴더 변경은 커밋 메시지에서 생략 (자동 설정 파일)
- 민감한 파일(.env 등)이 포함되어 있으면 경고
- 대량 변경(50개 이상 파일) 시 사용자 확인 요청
- main 브랜치에 직접 푸시하는 경우 경고
- PR 머지 전 CI/체크 통과 여부 확인
- 머지 충돌 발생 시 사용자에게 수동 해결 안내
